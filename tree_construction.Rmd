---
title: "Tree Construction"
output:
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r, message=FALSE, warning=FALSE}
library(ape)
library(ctv)
#update.views('Phylogenetics')
```




## Tree Construction: 

* loading the result. 

```{r}
DistanceMatrix = as.matrix(read.table('Bottleneck_Dist.txt', sep = ','))
Data = read.csv2(file = 'Bottleneck_Dist.csv', sep = ';', encoding = 'utf-8') 
labels = colnames(Data) ## accessing the names of types
labels = labels[-1]
Labels = gsub("[.]", "/ ",labels)
Labels
```


* Loading the labels to the vertex of the distance matrix:


```{r}
## assign label names to matrix: 
row.names(DistanceMatrix) = Labels 
colnames(DistanceMatrix) = Labels
## convert to distance format 
MyDistanceMat = as.dist(DistanceMatrix)
```



# Buidling a neighbor-joining (nj) tree: 

* Neighbor Joining is one of the most common ways to build a tree using molecular data thatâ€™s been converted to sequences; its one of the options within BLAST.

* Build the tree with `nj()`: 


```{r, fig.height=30, fig.width=15, fig.align="center"}
png('tree_flu.png', width = 1200, height = 1500)
NJ_tree = ape::nj(MyDistanceMat)
plot(NJ_tree)
```